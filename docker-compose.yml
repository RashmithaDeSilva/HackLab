version: '3.8'

services:
    kali-linux-c:
        image: kalilinux/kali-rolling
        container_name: kali-linux-c
        stdin_open: true  # Equivalent to -i
        tty: true         # Equivalent to -t
        restart: unless-stopped
        networks:
            hacking-lab-ex:
            hacking-lab-in:
                ipv4_address: 172.20.2.5  # Fixed IP for kali-linux-c container (must match subnet)

    kali-linux-vc:
        image: lscr.io/linuxserver/kali-linux
        container_name: kali-linux-vc
        security_opt: # optional
            - seccomp=unconfined
        environment:
            - PUID=1000 # Replace with your pc id (that can get using this command 'id')
            - PGID=1000 # Replace with your pc id (that can get using this command 'id')
            - TZ=America/Los_Angeles
            - SUBFOLDER=/
            - TITLE=Kali-Linux-VC # optional
            - CUSTOM_USER=kali # optional
            - PASSWORD=kali # optional
        volumes:
            - /path/to/data:/config # optional 
            - /var/run/docker.sock:/var/run/docker.sock # optional
        ports:
            - 3000:3000
            - 3001:3001
        devices:
            - "/dev/dir:/dev/dir" # optional (This will connect your GPU with Container and this will work with only Linux)
        shm_size: "1gb"
        restart: unless-stopped
        networks:
            hacking-lab-ex:
            hacking-lab-in:
                ipv4_address: 172.20.2.10  # Fixed IP for kali-linux-vc container (must match subnet)

    vulnerable-dvwac:
        image: vulnerables/web-dvwa
        restart: unless-stopped
        networks:
            hacking-lab-in:
                ipv4_address: 172.20.2.3  # Fixed IP for vulnerable-dvwac container (must match subnet)

networks:
    hacking-lab-ex: # External network for internet access
        driver: bridge
        ipam:
            config:
                - subnet: 172.20.1.0/24

    hacking-lab-in: # Internal network for communication between containers
        driver: bridge
        internal: true
        ipam:
            config:
                - subnet: 172.20.2.0/24